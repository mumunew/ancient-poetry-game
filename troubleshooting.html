<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•…éšœæ’é™¤ - Supabase é…ç½®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .content {
            padding: 40px;
        }

        .problem-section {
            margin-bottom: 40px;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
        }

        .problem-header {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .problem-header:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
        }

        .problem-header h3 {
            font-size: 1.3em;
            display: flex;
            align-items: center;
        }

        .problem-icon {
            font-size: 1.5em;
            margin-right: 15px;
        }

        .expand-icon {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .problem-content {
            padding: 30px;
            display: none;
            background: #f8f9fa;
        }

        .problem-content.active {
            display: block;
        }

        .solution-step {
            margin-bottom: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }

        .solution-step h4 {
            color: #28a745;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .code-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 10px 0;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .warning-box {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            color: #856404;
        }

        .info-box {
            background: #d1ecf1;
            border: 2px solid #bee5eb;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            color: #0c5460;
        }

        .success-box {
            background: #d4edda;
            border: 2px solid #c3e6cb;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            color: #155724;
        }

        .quick-links {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .quick-links h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .link-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .quick-link {
            display: block;
            padding: 15px 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-decoration: none;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .quick-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .search-box {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .search-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.1em;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .content {
                padding: 20px;
            }

            .problem-content {
                padding: 20px;
            }

            .link-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”§ æ•…éšœæ’é™¤</h1>
            <p>è§£å†³ Supabase é…ç½®ä¸­çš„å¸¸è§é—®é¢˜</p>
        </div>

        <div class="content">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="ğŸ” æœç´¢é—®é¢˜å…³é”®è¯..." onkeyup="searchProblems()">
            </div>

            <div class="problem-section" data-keywords="cors è·¨åŸŸ è®¿é—® è¢«é˜»æ­¢ policy">
                <div class="problem-header" onclick="toggleProblem(this)">
                    <h3><span class="problem-icon">ğŸš«</span>CORS è·¨åŸŸè®¿é—®è¢«é˜»æ­¢</h3>
                    <span class="expand-icon">â–¼</span>
                </div>
                <div class="problem-content">
                    <div class="warning-box">
                        <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "Access to fetch at 'https://api.supabase.com/...' from origin 'http://localhost:8086' has been blocked by CORS policy"
                    </div>
                    
                    <div class="solution-step">
                        <h4>è§£å†³æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ç®€åŒ–é…ç½®æ–¹æ¡ˆ</h4>
                        <p>æˆ‘ä»¬å·²ç»ä¸ºæ‚¨å‡†å¤‡äº†é¿å… CORS é—®é¢˜çš„ç®€åŒ–é…ç½®æ–¹æ¡ˆï¼š</p>
                        <p><a href="simple-setup.html" style="color: #007bff;">ğŸ‘‰ è®¿é—®ç®€åŒ–é…ç½®é¡µé¢</a></p>
                    </div>

                    <div class="solution-step">
                        <h4>è§£å†³æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ HTTPS æœåŠ¡å™¨</h4>
                        <p>å¦‚æœå¿…é¡»ä½¿ç”¨è‡ªåŠ¨åŒ–é…ç½®ï¼Œè¯·ä½¿ç”¨ HTTPS æœåŠ¡å™¨ï¼š</p>
                        <div class="code-example">npm install -g http-server
http-server -S -C cert.pem -K key.pem</div>
                    </div>

                    <div class="info-box">
                        <strong>ä¸ºä»€ä¹ˆä¼šå‡ºç° CORS é”™è¯¯ï¼Ÿ</strong><br>
                        æµè§ˆå™¨çš„åŒæºç­–ç•¥é˜»æ­¢äº†ä» HTTP é¡µé¢è®¿é—® HTTPS APIã€‚Supabase Management API åªèƒ½é€šè¿‡ HTTPS è®¿é—®ã€‚
                    </div>
                </div>
            </div>

            <div class="problem-section" data-keywords="é…ç½® æ–‡ä»¶ æœªæ‰¾åˆ° config undefined">
                <div class="problem-header" onclick="toggleProblem(this)">
                    <h3><span class="problem-icon">ğŸ“</span>é…ç½®æ–‡ä»¶æœªæ‰¾åˆ°æˆ–æœªåŠ è½½</h3>
                    <span class="expand-icon">â–¼</span>
                </div>
                <div class="problem-content">
                    <div class="warning-box">
                        <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "SUPABASE_CONFIG is not defined" æˆ– "Cannot read property 'url' of undefined"
                    </div>
                    
                    <div class="solution-step">
                        <h4>æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨</h4>
                        <p>ç¡®ä¿ <code>js/config.js</code> æ–‡ä»¶å­˜åœ¨ä¸”å†…å®¹æ­£ç¡®ï¼š</p>
                        <div class="code-example">const SUPABASE_CONFIG = {
    url: 'https://your-project.supabase.co',
    anonKey: 'your-anon-key-here',
    feedbackTable: 'game_feedback'
};</div>
                    </div>

                    <div class="solution-step">
                        <h4>æ£€æŸ¥æ–‡ä»¶å¼•ç”¨</h4>
                        <p>ç¡®ä¿åœ¨ HTML æ–‡ä»¶ä¸­æ­£ç¡®å¼•ç”¨äº†é…ç½®æ–‡ä»¶ï¼š</p>
                        <div class="code-example">&lt;script src="js/config.js"&gt;&lt;/script&gt;</div>
                    </div>

                    <div class="solution-step">
                        <h4>ä½¿ç”¨é…ç½®ç”Ÿæˆå™¨</h4>
                        <p>ä½¿ç”¨æˆ‘ä»¬çš„é…ç½®ç”Ÿæˆå™¨è‡ªåŠ¨åˆ›å»ºæ­£ç¡®çš„é…ç½®æ–‡ä»¶ï¼š</p>
                        <p><a href="simple-setup.html#configGenerator" style="color: #007bff;">ğŸ‘‰ ä½¿ç”¨é…ç½®ç”Ÿæˆå™¨</a></p>
                    </div>
                </div>
            </div>

            <div class="problem-section" data-keywords="è¿æ¥ å¤±è´¥ ç½‘ç»œ è¶…æ—¶ timeout">
                <div class="problem-header" onclick="toggleProblem(this)">
                    <h3><span class="problem-icon">ğŸŒ</span>æ•°æ®åº“è¿æ¥å¤±è´¥</h3>
                    <span class="expand-icon">â–¼</span>
                </div>
                <div class="problem-content">
                    <div class="warning-box">
                        <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "Failed to fetch" æˆ– "Network request failed" æˆ–è¿æ¥è¶…æ—¶
                    </div>
                    
                    <div class="solution-step">
                        <h4>æ£€æŸ¥é¡¹ç›®çŠ¶æ€</h4>
                        <p>1. ç™»å½• Supabase æ§åˆ¶å°</p>
                        <p>2. ç¡®è®¤é¡¹ç›®çŠ¶æ€ä¸º "Active"ï¼ˆç»¿è‰²ï¼‰</p>
                        <p>3. å¦‚æœé¡¹ç›®å¤„äº "Paused" çŠ¶æ€ï¼Œç‚¹å‡» "Restore" æ¢å¤</p>
                    </div>

                    <div class="solution-step">
                        <h4>éªŒè¯ URL å’Œå¯†é’¥</h4>
                        <p>ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„é¡¹ç›® URL å’ŒåŒ¿åå¯†é’¥ï¼š</p>
                        <div class="code-example">// æ­£ç¡®çš„ URL æ ¼å¼
https://abcdefghijklmnop.supabase.co

// æ­£ç¡®çš„å¯†é’¥æ ¼å¼ï¼ˆä»¥ eyJ å¼€å¤´ï¼‰
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</div>
                    </div>

                    <div class="solution-step">
                        <h4>æ£€æŸ¥ç½‘ç»œè¿æ¥</h4>
                        <p>1. ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸</p>
                        <p>2. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®</p>
                        <p>3. å°è¯•åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®é¡¹ç›® URL</p>
                    </div>
                </div>
            </div>

            <div class="problem-section" data-keywords="è¡¨ ä¸å­˜åœ¨ table does not exist 404">
                <div class="problem-header" onclick="toggleProblem(this)">
                    <h3><span class="problem-icon">ğŸ“Š</span>æ•°æ®è¡¨ä¸å­˜åœ¨</h3>
                    <span class="expand-icon">â–¼</span>
                </div>
                <div class="problem-content">
                    <div class="warning-box">
                        <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "relation 'public.game_feedback' does not exist" æˆ– 404 é”™è¯¯
                    </div>
                    
                    <div class="solution-step">
                        <h4>æ‰§è¡Œ SQL è„šæœ¬</h4>
                        <p>1. åœ¨ Supabase æ§åˆ¶å°ä¸­æ‰“å¼€ "SQL Editor"</p>
                        <p>2. å¤åˆ¶å¹¶æ‰§è¡Œæˆ‘ä»¬æä¾›çš„ SQL è„šæœ¬</p>
                        <p><a href="simple-setup.html" style="color: #007bff;">ğŸ‘‰ è·å– SQL è„šæœ¬</a></p>
                    </div>

                    <div class="solution-step">
                        <h4>éªŒè¯è¡¨åˆ›å»º</h4>
                        <p>åœ¨ SQL Editor ä¸­è¿è¡Œä»¥ä¸‹æŸ¥è¯¢éªŒè¯è¡¨æ˜¯å¦å­˜åœ¨ï¼š</p>
                        <div class="code-example">SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name = 'game_feedback';</div>
                    </div>

                    <div class="solution-step">
                        <h4>æ£€æŸ¥è¡¨æƒé™</h4>
                        <p>ç¡®ä¿å¯ç”¨äº† Row Level Security å¹¶è®¾ç½®äº†æ­£ç¡®çš„ç­–ç•¥ï¼š</p>
                        <div class="code-example">-- æ£€æŸ¥ RLS çŠ¶æ€
SELECT schemaname, tablename, rowsecurity 
FROM pg_tables 
WHERE tablename = 'game_feedback';

-- æ£€æŸ¥ç­–ç•¥
SELECT * FROM pg_policies WHERE tablename = 'game_feedback';</div>
                    </div>
                </div>
            </div>

            <div class="problem-section" data-keywords="æƒé™ 403 forbidden rls policy">
                <div class="problem-header" onclick="toggleProblem(this)">
                    <h3><span class="problem-icon">ğŸ”’</span>æƒé™è¢«æ‹’ç» (403 é”™è¯¯)</h3>
                    <span class="expand-icon">â–¼</span>
                </div>
                <div class="problem-content">
                    <div class="warning-box">
                        <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "403 Forbidden" æˆ– "new row violates row-level security policy"
                    </div>
                    
                    <div class="solution-step">
                        <h4>æ£€æŸ¥ RLS ç­–ç•¥</h4>
                        <p>ç¡®ä¿ä¸ºåŒ¿åç”¨æˆ·è®¾ç½®äº†æ­£ç¡®çš„ç­–ç•¥ï¼š</p>
                        <div class="code-example">-- å…è®¸åŒ¿åç”¨æˆ·æ’å…¥æ•°æ®
CREATE POLICY "Allow anonymous insert" ON game_feedback
    FOR INSERT TO anon
    WITH CHECK (true);

-- å…è®¸åŒ¿åç”¨æˆ·è¯»å–æ•°æ®
CREATE POLICY "Allow read feedback" ON game_feedback
    FOR SELECT TO anon
    USING (true);</div>
                    </div>

                    <div class="solution-step">
                        <h4>é‡æ–°åˆ›å»ºç­–ç•¥</h4>
                        <p>å¦‚æœç­–ç•¥æœ‰é—®é¢˜ï¼Œå…ˆåˆ é™¤å†é‡æ–°åˆ›å»ºï¼š</p>
                        <div class="code-example">-- åˆ é™¤ç°æœ‰ç­–ç•¥
DROP POLICY IF EXISTS "Allow anonymous insert" ON game_feedback;
DROP POLICY IF EXISTS "Allow read feedback" ON game_feedback;

-- é‡æ–°åˆ›å»ºç­–ç•¥
CREATE POLICY "Allow anonymous insert" ON game_feedback
    FOR INSERT TO anon
    WITH CHECK (true);

CREATE POLICY "Allow read feedback" ON game_feedback
    FOR SELECT TO anon
    USING (true);</div>
                    </div>

                    <div class="solution-step">
                        <h4>éªŒè¯åŒ¿åå¯†é’¥</h4>
                        <p>ç¡®ä¿ä½¿ç”¨çš„æ˜¯ "anon public" å¯†é’¥ï¼Œè€Œä¸æ˜¯ "service_role" å¯†é’¥ã€‚</p>
                    </div>
                </div>
            </div>

            <div class="problem-section" data-keywords="æ•°æ® æ’å…¥ å¤±è´¥ constraint çº¦æŸ">
                <div class="problem-header" onclick="toggleProblem(this)">
                    <h3><span class="problem-icon">ğŸ’¾</span>æ•°æ®æ’å…¥å¤±è´¥</h3>
                    <span class="expand-icon">â–¼</span>
                </div>
                <div class="problem-content">
                    <div class="warning-box">
                        <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "violates check constraint" æˆ– "null value in column"
                    </div>
                    
                    <div class="solution-step">
                        <h4>æ£€æŸ¥å¿…å¡«å­—æ®µ</h4>
                        <p>ç¡®ä¿æä¾›äº†å¿…è¦çš„æ•°æ®å­—æ®µï¼š</p>
                        <div class="code-example">const feedbackData = {
    player_name: 'ç©å®¶åç§°',        // å¯é€‰
    contact_info: 'è”ç³»æ–¹å¼',      // å¯é€‰ï¼Œä½†ä¸ suggestions è‡³å°‘ä¸€ä¸ªä¸ä¸ºç©º
    suggestions: 'åé¦ˆå»ºè®®',       // å¯é€‰ï¼Œä½†ä¸ contact_info è‡³å°‘ä¸€ä¸ªä¸ä¸ºç©º
    score: 100,                   // å¿…é¡» >= 0
    accuracy: 95.5,               // å¿…é¡»åœ¨ 0-100 ä¹‹é—´
    play_time: 300,               // å¿…é¡» >= 0
    current_level: 5,             // å¿…é¡» >= 1
    max_levels: 10                // å¿…é¡» >= 1ï¼Œä¸” >= current_level
};</div>
                    </div>

                    <div class="solution-step">
                        <h4>éªŒè¯æ•°æ®æ ¼å¼</h4>
                        <p>æ£€æŸ¥æ•°æ®ç±»å‹å’Œçº¦æŸæ¡ä»¶ï¼š</p>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>score: æ•´æ•°ï¼Œ>= 0</li>
                            <li>accuracy: å°æ•°ï¼Œ0-100 ä¹‹é—´</li>
                            <li>play_time: æ•´æ•°ï¼Œ>= 0</li>
                            <li>current_level: æ•´æ•°ï¼Œ>= 1</li>
                            <li>max_levels: æ•´æ•°ï¼Œ>= current_level</li>
                        </ul>
                    </div>

                    <div class="solution-step">
                        <h4>ä½¿ç”¨æµ‹è¯•å·¥å…·</h4>
                        <p>ä½¿ç”¨æˆ‘ä»¬çš„é…ç½®æµ‹è¯•å·¥å…·éªŒè¯æ•°æ®æ’å…¥ï¼š</p>
                        <p><a href="config-test.html" style="color: #007bff;">ğŸ‘‰ æ‰“å¼€é…ç½®æµ‹è¯•å·¥å…·</a></p>
                    </div>
                </div>
            </div>

            <div class="quick-links">
                <h3>ğŸ”— å¿«é€Ÿé“¾æ¥</h3>
                <div class="link-grid">
                    <a href="simple-setup.html" class="quick-link">ğŸ› ï¸ ç®€åŒ–é…ç½®</a>
                    <a href="config-test.html" class="quick-link">ğŸ§ª é…ç½®æµ‹è¯•</a>
                    <a href="auto-setup.html" class="quick-link">âš™ï¸ é…ç½®å‘å¯¼</a>
                    <a href="setup-supabase.md" class="quick-link">ğŸ“– è¯¦ç»†æŒ‡å—</a>
                </div>
            </div>

            <div class="info-box">
                <h4>ğŸ’¡ ä»ç„¶é‡åˆ°é—®é¢˜ï¼Ÿ</h4>
                <p>å¦‚æœä»¥ä¸Šè§£å†³æ–¹æ¡ˆéƒ½æ— æ³•è§£å†³æ‚¨çš„é—®é¢˜ï¼Œè¯·ï¼š</p>
                <ol style="margin: 10px 0; padding-left: 20px;">
                    <li>ä½¿ç”¨é…ç½®æµ‹è¯•å·¥å…·è¿›è¡Œå…¨é¢æ£€æŸ¥</li>
                    <li>æŸ¥çœ‹æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°é”™è¯¯ä¿¡æ¯</li>
                    <li>ç¡®è®¤ Supabase é¡¹ç›®çŠ¶æ€æ­£å¸¸</li>
                    <li>é‡æ–°æŒ‰ç…§ç®€åŒ–é…ç½®æ­¥éª¤æ“ä½œ</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        function toggleProblem(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.expand-icon');
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                icon.textContent = 'â–¼';
                icon.style.transform = 'rotate(0deg)';
            } else {
                // å…³é—­å…¶ä»–æ‰“å¼€çš„é—®é¢˜
                document.querySelectorAll('.problem-content.active').forEach(el => {
                    el.classList.remove('active');
                    el.previousElementSibling.querySelector('.expand-icon').textContent = 'â–¼';
                    el.previousElementSibling.querySelector('.expand-icon').style.transform = 'rotate(0deg)';
                });
                
                content.classList.add('active');
                icon.textContent = 'â–²';
                icon.style.transform = 'rotate(180deg)';
            }
        }

        function searchProblems() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const problemSections = document.querySelectorAll('.problem-section');
            
            problemSections.forEach(section => {
                const keywords = section.getAttribute('data-keywords').toLowerCase();
                const title = section.querySelector('h3').textContent.toLowerCase();
                
                if (keywords.includes(searchTerm) || title.includes(searchTerm) || searchTerm === '') {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
        }

        // é¡µé¢åŠ è½½æ—¶çš„æç¤º
        window.addEventListener('load', () => {
            console.log('ğŸ”§ æ•…éšœæ’é™¤å·¥å…·å·²åŠ è½½');
            console.log('ğŸ’¡ ä½¿ç”¨æœç´¢åŠŸèƒ½å¿«é€Ÿæ‰¾åˆ°è§£å†³æ–¹æ¡ˆ');
        });
    </script>
</body>
</html>